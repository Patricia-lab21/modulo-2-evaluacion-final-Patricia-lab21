"use strict";const asideFav=document.querySelector(".aside_favourites"),listFav=document.querySelector(".listFav"),listMovies=document.querySelector(".listMovies"),input=document.querySelector(".input"),button=document.querySelector(".button"),baseUrl="https://api.tvmaze.com/search/shows?q=";let totalMovies=null,selectedMovies=readLocalStorage();function startPage(){fetch(baseUrl+input.value).then(e=>e.json()).then(e=>{totalMovies=e,printFilms(totalMovies)})}function printFilms(e){listMovies.innerHTML="";for(let t of e)null===t.show.image?listMovies.innerHTML+=`<li class ="myLi normalColor" id=${t.show.id}><img src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV"><span class="spanLi"></span><h3 class="titleMovie">${t.show.name}</h3></li>`:listMovies.innerHTML+=`<li class ="myLi normalColor" id=${t.show.id}><img src=${t.show.image.medium}><span class="spanLi"><h3 class="titleMovie">${t.show.name}</h3></li>`,addListeners()}function addListeners(){const e=document.querySelectorAll(".myLi");for(let t of e)t.addEventListener("click",addFavs)}function setLocalStorage(){localStorage.setItem("myFavourites",JSON.stringify(selectedMovies))}function readLocalStorage(){let e=JSON.parse(localStorage.getItem("myFavourites"));return null!==e?e:[]}function getFavouriteObject(e){return totalMovies.find(t=>t.show.id===parseInt(e))}function addFavs(e){e.currentTarget.classList.remove("normalColor"),e.currentTarget.classList.add("favColor");const t=getFavouriteObject(e.currentTarget.id);-1===selectedMovies.indexOf(t.show)?(selectedMovies.push(t.show),setLocalStorage(),printFavourites(selectedMovies)):alert("This film is alredy your favourite")}function printFavourites(e){listFav.innerHTML="";for(let t of e)null!==t.image?(listFav.innerHTML+=`<li class ="myFavouriteLi" id=${t.id}><img src=${t.image.medium}><span class="spanFavouriteLi"></span><button type="button" class="button__remove">Borrar</button><span class="spanFavouriteLi"><h3 class="titleMovieFavourite">${t.name}</h3></li>`,asideFav.classList.remove("hidden")):(listFav.innerHTML+=`<li class ="myFavouriteLi" id=${t.id}><img src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV"><span class="spanFavouriteLi"></span><button id=${t.id} type="button" class="button__remove">Borrar</button><span class="spanFavouriteLi"><h3 class="titleMovieFavourite">${t.name}</h3></li>`,asideFav.classList.remove("hidden"));addRemoveListeners()}function addRemoveListeners(){const e=document.querySelectorAll(".button__remove");for(let t of e)t.addEventListener("click",removeFavourite)}function removeFavourite(e){let t=e.currentTarget.parentElement.id,s=e.currentTarget.parentElement,i=e.currentTarget.id;console.log(e.currentTarget),(i=t)&&selectedMovies.splice(s,1),setLocalStorage(),printFavourites(selectedMovies)}printFavourites(selectedMovies),button.addEventListener("click",startPage);